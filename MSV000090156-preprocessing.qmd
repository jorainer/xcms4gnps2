---
title: "xcms-based preprocessing of LC-MS/MS data for feature-based molecular
networking with GNPS2"
format:
  html
authors: Philippine Louail, Steffen Neumann, Johannes Rainer
---


# Introduction

This document describes data inspection and preprocessing of an LC-MS/MS data
set using *xcms* and export of the data for subsequent feature-based molecular
networking (FBMN) with GNPS2. Functionality from different packages from the
RforMassSpectrometry package ecosystem are combined to visualize and process the
data.

# Required software packages

The various software packages required for the analysis are defined and loaded
below. All packages are available through Bioconductor or CRAN and can be
installed with `BiocManager::install(<package name>)`.

```{r}
library(Spectra) # main MS infrastructure for R
library(MsExperiment) # container for MS data
library(xcms)    # for preprocessing of LC-MS and LC-MS/MS data
```

# Data import

The data analyzed here is part of the MassIVE [MSV000090156]() data set. Before
loading the data we define a `data.frame` with sample and experiment-specific
information for the individual MS runs/data files.

```{r}
pd <- data.frame(
    file_name = ,
    sample_name = ,
    replicate = ,
    injection_index = xxx
)
```


# Data visualization and general quality assessment

- BPC
- BPS

# Data preprocessing

Data preprocessing is the first step in the analysis of LC-MS data processing
and analyzing the raw MS data to result in a two-dimensional quantification
table of LC-MS *features* in the various samples of the experiment. This process
consists of 3 main steps: **chromatographic peak detection**, **retention time
alignment** and **correspondence analysis**. An additional **gap-filling** step
can be conducted to reduce the number of missing values integrating raw MS
signal from the expected *m/z* by retention time areas of defined LC-MS
features.

## Chromatographic peak detection

The aim of the chromatographic peak detection is to identify and quantify signal
in the raw MS data space representing signal from ions of compounds present in
a sample. Data processing is performed separately for each data file and signal
along retention time axis are evaluated ....

## Retention time alignment

## Correspondence analysis

## Gap-filling

# Formatting and exporting data for FBMS

# Session information
